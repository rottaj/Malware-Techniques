//
// Created by j4ck on 3/7/24.
//

#ifndef UDLR_LDR_H
#define UDLR_LDR_H

#include <windows.h>
#include "Utils.h"

typedef struct {
    struct {
        PIMAGE_NT_HEADERS pNtHeaders;
        PIMAGE_OPTIONAL_HEADER pOptionalHeader;
    } PE_HDRS;
    struct {
        fn_vsnprintf _vsnprintf;
        fnHeapAlloc _HeapAlloc;
        fnHeapFree _HeapFree;
        fnOutputDebugString _OutputDebugString;
        fnGetProcessHeap _GetProcessHeap;
        fnAllocConsole _AllocConsole;
        fnGetStdHandle _GetStdHandle;
        fn_fdopen _fdopen;
        fn_open_osfhandle _open_osfhandle;
        fnsetvbuf _setvbuf;
    } Win32;
} LDR_INSTANCE, *PLDR_INSTANCE;


#endif //UDLR_LDR_H
